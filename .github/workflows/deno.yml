name: Deno

on:
  schedule:
    # 毎週月曜日 10:00
    - cron: '0 10 * * 1'

jobs:
  test:
    runs-on: ubuntu-latest
    name: "Diff"
    steps:
      - name: Setup repo
        uses: actions/checkout@v2

      - name: Setup Deno
        # uses: denoland/setup-deno@v1
        uses: denoland/setup-deno@004814556e37c54a2f6e31384c9e18e983317366
        with:
          deno-version: v1.x

      - name: Download last-time result JSON
        uses: actions/download-artifact@v2
        with:
          name: result-json

      - name: Run Script
        id: diff
        run: |
          deno run -A --unstable https://raw.githubusercontent.com/daichi-okamura/deno-scripts/main/oshirase-list.ts

      - name: Upload result JSON
        uses: actions/upload-artifact@v2
        with:
          name: result-json
          path: old.json
          retention-days: 8

      - name: Notify
        run: |
          echo ${{diff.outputs.test}}
